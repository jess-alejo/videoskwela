- page_title @lesson.title

%nav{"aria-label" => "breadcrumb"}
  %ol.breadcrumb
    %li.breadcrumb-item
      = link_to 'Courses', courses_path
    %li.breadcrumb-item
      = link_to @course.title, course_path(@course)
    %li.breadcrumb-item.active{"aria-current" => "page"}
      = @lesson.title
.row
  .col-lg-8
    = render 'lessons/lesson', course: @course, lesson: @lesson
    - if @lesson.video.attached?
      %video(controls="true" poster="#{url_for @lesson.video_thumbnail}" width="100%" preload="metadata")
        %source{ src: rails_blob_url(@lesson.video), type: "#{@lesson.video.content_type}" }
  .col-lg-4
    .card
      .card-body
        .d-flex.justify-content-between
          %h5.card-title
            = link_to @course.title, @course
          .course-progress
            .fa.fa-spinner
            = number_to_percentage(@course.progress(current_user), precision: 0)

        %ul.list-group.mb-3
        - @lessons.each do |lesson|
          %li.list-group-item{ class: ('list-group-item-success' if lesson == @lesson) }
            = render 'lessons/lesson_preview', lesson: lesson